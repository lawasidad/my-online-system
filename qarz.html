<!DOCTYPE html>
<html lang="ku">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>داشبۆردی قەرز</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">
  <h2 class="text-center mb-4">📋 داشبۆردی بەڕێوەبردنی قەرز</h2>

  <!-- Tabs -->
  <ul class="nav nav-tabs mb-4" id="debtTabs">
    <li class="nav-item">
      <a class="nav-link active" data-bs-toggle="tab" href="#addDebt">➕ زیادکردنی قەرز</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="tab" href="#returnDebt">↩️ گەراندنەوەی قەرز</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="tab" href="#debtList">📊 کەشفی قەرزدار</a>
    </li>
  </ul>

  <div class="tab-content">
    <!-- Add Debt -->
    <div class="tab-pane fade show active" id="addDebt">
      <div class="card p-3 shadow-sm">
        <form id="addDebtForm">
          <input class="form-control mb-2" id="customer" placeholder="ناوی قەرزداری" required>
          <input class="form-control mb-2" type="number" id="amount" placeholder="بڕی قەرز" required>
          <input class="form-control mb-2" type="date" id="date" required>
          <input class="form-control mb-3" id="details" placeholder="وردەکاری (هەڵبژێری)">
          <button type="submit" class="btn btn-primary w-100">تۆمارکردن</button>
        </form>
      </div>
    </div>

    <!-- Return Debt -->
    <div class="tab-pane fade" id="returnDebt">
      <div class="card p-3 shadow-sm">
        <form id="returnDebtForm">
          <input class="form-control mb-2" id="returnCustomer" placeholder="ناوی قەرزداری" required>
          <input class="form-control mb-2" type="number" id="returnAmount" placeholder="بڕی گەڕاوە" required>
          <input class="form-control mb-3" type="date" id="returnDate" required>
          <button type="submit" class="btn btn-success w-100">تۆمارکردنی گەڕاندنەوە</button>
        </form>
      </div>
    </div>

    <!-- Debt List -->
    <div class="tab-pane fade" id="debtList">
      <div class="card p-3 shadow-sm">
        <input class="form-control mb-3" id="searchCustomer" placeholder="گەڕان بە ناو..." oninput="searchDebt()">
        <table class="table table-bordered table-striped">
          <thead class="table-dark">
            <tr>
              <th>ناو</th>
              <th>بڕ</th>
              <th>بەروار</th>
              <th>جۆر</th>
              <th>وردەکاری</th>
            </tr>
          </thead>
          <tbody id="debtTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
  let debts = JSON.parse(localStorage.getItem("debts") || "[]");

  function saveData() {
    localStorage.setItem("debts", JSON.stringify(debts));
    renderTable();
  }

  function renderTable(filtered = null) {
    const table = document.getElementById("debtTableBody");
    table.innerHTML = "";
    (filtered || debts).forEach(item => {
      const row = `<tr>
        <td>${item.name}</td>
        <td>${item.amount}</td>
        <td>${item.date}</td>
        <td>${item.type}</td>
        <td>${item.details || "-"}</td>
      </tr>`;
      table.innerHTML += row;
    });
  }

  document.getElementById("addDebtForm").addEventListener("submit", e => {
    e.preventDefault();
    debts.push({
      name: document.getElementById("customer").value,
      amount: parseFloat(document.getElementById("amount").value),
      date: document.getElementById("date").value,
      type: "قەرز",
      details: document.getElementById("details").value
    });
    e.target.reset();
    saveData();
  });

  document.getElementById("returnDebtForm").addEventListener("submit", e => {
    e.preventDefault();
    debts.push({
      name: document.getElementById("returnCustomer").value,
      amount: -parseFloat(document.getElementById("returnAmount").value),
      date: document.getElementById("returnDate").value,
      type: "گەڕاوە",
      details: ""
    });
    e.target.reset();
    saveData();
  });

  function searchDebt() {
    const q = document.getElementById("searchCustomer").value.toLowerCase();
    const filtered = debts.filter(d => d.name.toLowerCase().includes(q));
    renderTable(filtered);
  }

  renderTable();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
